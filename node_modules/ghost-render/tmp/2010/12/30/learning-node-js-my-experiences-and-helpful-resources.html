<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>Learning node.js: my experiences and helpful resources</title>	

	<meta name="description" content="">
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Learning node.js: my experiences and helpful resources">
    <meta name="twitter:description" content="">
    <meta name="twitter:site" content="@username">
	<meta name="twitter:creator" content="@username">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Learning node.js: my experiences and helpful resources">
    <meta property="og:description" content="">

    <link rel="stylesheet" href="/assets/css/style.css">

    <meta name="generator" content="Ghost ?" />
<link rel="alternate" type="application/rss+xml" title="Mixu&#39;s blog" href="/rss/">
<link rel="canonical" href="http://localhost:5000//2010/12/30/learning-node-js-my-experiences-and-helpful-resources.md" />	
</head>
<body class="post-template">
	
<main id="container" role="main">
	<header class="header" role="banner" style="background-image: url(/assets/img/header.jpg);">
		<h1 class="blog-title">
			<a href="http://localhost:5000">Mixu&#x27;s blog</a>
		</h1>
		<div class="blog-description">A blog</div>
	</header>
	<nav class="menu" role="navigation">
		<a href="#">Home</a>
		<span class="delimiter">&#8226;</span>
		<a href="#">About</a>
		<span class="delimiter">&#8226;</span>
		<a href="#">Contacts</a>
	</nav>
	<section class="post-full">
		<article itemscope itemtype="http://schema.org/BlogPosting" role="article" class="post">
			<header class="post-header">        		
    			<h2 itemprop="name headline" class="post-title">
    				<a href="/2010/12/30/learning-node-js-my-experiences-and-helpful-resources.html" itemprop="url">Learning node.js: my experiences and helpful resources</a>
    			</h2>
    			<div class="post-meta">
        			<time datetime="2010-12-30" itemprop="datePublished">December 30, 2010</time>
        		</div>
        		<hr>
    		</header>
    		<section itemprop="articleBody" class="post-content">
    			<p>Here are my notes from learning node.js over the winter vacation. You can think of this post as asking me <em>what resources did you find helpful in learning node.js?</em> There is a lot of node.js stuff out there, but few posts on what is noteworthy, popular or tricky - I am sick of seeing posts explaining what node.js is and showing me the same five lines of code.</p>
<h2>Structuring code</h2>
I recommend reading the series on control flow in node.js from Tim Caswell:
<ul>
    <li><a href="http://howtonode.org/control-flow">http://howtonode.org/control-flow</a></li>
    <li><a href="http://howtonode.org/control-flow-part-ii">http://howtonode.org/control-flow-part-ii</a></li>
    <li><a href="http://howtonode.org/control-flow-part-iii">http://howtonode.org/control-flow-part-iii</a></li>
    <li><a href="http://howtonode.org/step-of-conductor">http://howtonode.org/step-of-conductor</a></li>
    <li><a href="http://howtonode.org/do-it-fast">http://howtonode.org/do-it-fast</a></li>
</ul>
Scope and this are different/tricky in JS, read <a href="http://howtonode.org/what-is-this">this</a> and <a href="http://stackoverflow.com/questions/4357881/how-can-i-maintain-scope-in-node-js-callbacks">this</a>.

<strong>Update Feb 2011:</strong>
<ul>
    <li>I wrote about <a href="http://blog.mixu.net/2011/02/01/understanding-the-node-js-event-loop/">the event loop in Node.js, and how it works</a>.</li>
    <li>And here is <a href="http://blog.mixu.net/2011/02/02/essential-node-js-patterns-and-snippets/">my list of essential patterns in Node.js</a>.</li>
    <li>And tomorrow (Feb 3rd), I&#39;ll publish something on the problems you run into with for loops.</li>
</ul>
<strong>Update Jan 2011: </strong>
<ul>
    <li>John Resig&#39;s <a href="http://ejohn.org/apps/learn/">online Javascript tutorial</a> is also great.</li>
    <li>You can refer back to this page about <a href="https://github.com/ry/node/wiki/ECMA-5-Mozilla-Features-Implemented-in-V8">what features of ECMAScript 5 are implemented in V8</a>.</li>
</ul>
<a href="http://www.bolinfest.com/javascript/inheritance.php">Inheritance patterns in Javascript</a> (using a modern style that optimizes well when using the Google Closure compiler).

You&#39;ll probably run into problems with assigning values if you use the class pattern. The problems is that adding variables in the prototype makes them shared among instances. You&#39;ll have to explicitly initialize any per-instance variables in the constructor, or otherwise the object instance will keep accessing the prototype property =&gt; property acts like it would be static. Obvious in retrospect, but hindsight makes fools of us all.
<h2>Modules</h2>
Have a look at the <a href="https://github.com/ry/node/wiki/modules">node.js modules page on github</a> for a comprehensive list of modules. Install <a href="http://npmjs.org/">npm</a> to install packages. Or don&#39;t, just drop the repos in a subdirectory and use require, since <a href="http://nodejs.org/docs/v0.3.2/api/modules.html">require in node.js is flexible</a>.
<h2>Debugging</h2>
Simply printing out stuff can be done using sys.puts(string) (first &quot;var sys = require(&#39;sys&#39;)&quot;).

Since you are on V8, you can use JSON.stringify(object) natively. console.log() also works, it automatically prettyprints objects, but only one level deep (no nested objects).

For those rare occasions where JSON.stringify(object) fails (e.g. due to recursion) you can use require(&#39;util&#39;).inspect(object) as an alternative.
<h2>Setting up the server</h2>
Update: Here is <a href="http://blog.mixu.net/2011/01/04/nginx-php-fpm-and-node-js-install-on-centos-5-5/">how I got Node.js up and running on Centos 5 with nginx + monit</a>.

First, you&#39;ll want to decide how you want to build your applications - will you use node.js for the whole stack, or will you mix it with more familiar scripting languages. If you want to mix two technology stacks, I strongly recommend NOT trying to combine node.js with other web app stacks using subdomains, since you&#39;ll have an unlimited amount of trouble due to the <a href="http://en.wikipedia.org/wiki/Same_origin_policy">same origin policy enforcement</a> that is built into all browsers. You can either solve that problem for all browsers:
<ul>
    <li>IE6/7 has no mechanism,</li>
    <li>IE8/9 has <a href="http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx">XDomainRequest</a>,</li>
    <li>Mozilla/Chrome/Opera have <a href="http://en.wikipedia.org/wiki/XMLHttpRequest">XMLHttpRequest </a>Level 2 (note that level 2 is needed for cross-domain support).</li>
</ul>
Or you can solve the problem on the server:
<ol>
    <li>by only using node.js for all of your stack, running a bare node.js server</li>
    <li>by running a mixed stack using Nginx or Apache to proxy node.js requests</li>
</ol>
I&#39;m not quite ready to start from scratch, given the productivity that my non-node-js stack gives; I did the mixed route with Apache which is adequate for trying things out. If you want to scale a bit more, you&#39;ll want to setup Nginx.

You can <a href="http://fortnightlabs.posterous.com/deploying-with-nodejs">proxy requests from Apache to Node.js</a> (<a href="http://groups.google.com/group/ajaxim/browse_thread/thread/b06b188dfc0e6a6d">second example</a>), or do a <a href="http://arguments.callee.info/2010/04/20/running-apache-and-node-js-together/">rewrite</a>. You&#39;ll want to use a subdirectory for node.js requests so that you don&#39;t have to deal with the same origin policy. Here is what I did:

<code>bash
&amp;lt;VirtualHost *:80&amp;gt;
    ServerAdmin webmaster@localhost
    DocumentRoot /path/to/www/
    ServerName example.com
    ProxyPass /node/ http://127.0.0.1:8001/ retry=0 timeout=120
    &amp;lt;Proxy *&amp;gt;
        Allow from all
    &amp;lt;/Proxy&amp;gt;
&amp;lt;/VirtualHost&amp;gt;</code>

The &quot;retry=0&quot; parameter prevents Apache from waiting 60 seconds if a node.js response fails (e.g. due to server restart).
<h2>Comet with node.js</h2>
Have a look at socket.io (<a href="https://github.com/LearnBoost/Socket.IO-node">github page</a>) for streaming. In my testing, I couldn&#39;t get it to work with IE9 (sending stuff) and Chrome seemed to keep dropping connections. Firefox worked solidly and Chrome after I set it to reconnect, but I couldn&#39;t figure out why IE9 was not working (it could receive messages, but sending them did not seem to work..). I am sure that socket.io will get there, <em>reliable</em> real-time transmission in all major browsers just isn&#39;t quite yet a problem that has been solved neatly. <a href="http://groups.google.com/group/socket_io/browse_thread/thread/b1a32a19d14dd000">There are still issues to resolve, it seems</a>. To be fair, that&#39;s for cross-domain requests.

If you use socket.io, you will probably want to implement your own abstractions over it, since you&#39;ll want to do something with channels. There is the broadcast(message, list_of_excluded_user_ids) method, but you probably want to have more fine-grained control which can be done via additional abstractions.

There are also two other promising comet projects: Push-it and Faye. Push-it (<a href="http://github.com/aaronblohowiak/Push-It">github</a>, <a href="http://stackoverflow.com/questions/4445883/node-websocket-server-possible-to-have-multiple-separate-broadcasts-for-a-sin/4446178#4446178">stackoverflow</a>) is built on top of socket.io. Faye (<a href="http://faye.jcoglan.com/">homepage</a>, <a href="http://github.com/jcoglan/faye">github</a>) also looks interesting but I spotted this to-do on the repo: &quot;Detect failed WebSocket connection and fall back to polling transports&quot; - e.g. it doesn&#39;t seem to work in non-Websocket browsers (IE6/IE7), something I would like to have (in fact right now, Dec 2010 <a href="http://hacks.mozilla.org/2010/12/websockets-disabled-in-firefox-4/">WebSockets is disabled in newer FF 4 builds and Opera 11 due to security concerns</a>).
<h2>Connecting to MySQL</h2>

<h2 id="comments">Comments</h2>
<p><strong><a href="#298" title="2011-01-04 12:01:07">Will Tran</a>:</strong> <a href="http://www.devcomments.com/Update-benchmarks-for-Node-js-MySQL-drivers-at290013.htm">http://www.devcomments.com/Update-benchmarks-for-Node-js-MySQL-drivers-at290013.htm</a></p>
<p><strong><a href="#300" title="2011-11-10 18:06:42">Jagdish Hiray</a>:</strong> This is really good article. Have you come across way to call server side node js from client side js?</p>
<p>Thank you.</p>
<p><strong><a href="#301" title="2011-11-10 20:46:54">Mikito Takada</a>:</strong> Yeah, you can do that either by exposing an API, or using something like nowjs, which does the wrapping for you.</p>
<p>PS - for more stuff, read my book: <a href="http://book.mixu.net/">http://book.mixu.net/</a></p>
<p><strong><a href="#610" title="2013-01-06 17:20:12">enz54</a>:</strong> hi mikito,
quick question
I&#39;m develop a website using express and I&#39;m having difficulty deploying online. Do you know any hosting companies out there? Is it crucial that the host support node.js or you can use anyone? I tried appfog but every time I update my app I&#39;ve got error:
name: VmcError, endpoint: PUT:/apps/:name, statusCode: 500, code: 310, description: Staging failed: &#39;Staging task failed:
Staging plugin failed: /opt/cloudfoundry/vcap/staging/lib/vcap/staging/plugin/node/plugin.rb:80:in <code>guess_main_file&#39;: Unable to determine Node.js startup command (RuntimeError)
from /opt/cloudfoundry/vcap/staging/lib/vcap/staging/plugin/node/plugin.rb:29:in</code>detect_start_command&#39;
from /opt/cloudfoundry/vcap/staging/lib/vcap/staging/plugin/node/node_autoconfig.rb:27:in <code>setup_autoconfig&#39;
from /opt/cloudfoundry/vcap/staging/lib/vcap/staging/plugin/node/plugin.rb:14:in</code>block in stage_application&#39;
from /opt/cloudfoundry/vcap/staging/lib/vcap/staging/plugin/node/plugin.rb:9:in <code>chdir&#39;
from /opt/cloudfoundry/vcap/staging/lib/vcap/staging/plugin/node/plugin.rb:9:in</code>stage_application&#39;
from /opt/cloudfoundry/vcap/stager/bin/run_plugin:19:in `&#39;</p>
<p>Your help will be just awesome!!!!</p>
<p>cheers
eric</p>

    		</section>
    		<footer class="post-footer">
    			<div itemscope itemprop="author" itemtype="http://schema.org/Person" class="post-author">
	                	<img itemprop="image" src="http://www.gravatar.com/avatar/F0AF2953911805542C66FD43B2F8FC38?s=155" alt="Mixu" class="post-author-avatar">
					<div class="post-author-info">
		              	<span itemprop="name">Mixu</span>
		              	<p itemprop="description" class="post-author-bio">Node.js developer</p>
	              	</div>
    			</div>
    		</footer>
		</article>
		
		<section itemprop="comment" class="post-comments">
			<div id="disqus_thread"></div>
			<script type="text/javascript">            
				var disqus_shortname = 'example';
		
			    (function() {
			        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
			        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
			        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			    })();
			</script>
			<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
			<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
		</section>	</section>

	<footer class="footer" role="contentinfo">
		<div class="social-links-line"></div>
		<section class="social-links">
	        <div class="social-links-inner">
	        	<a class="icon icon-feed" href="http://localhost:5000/rss/" target="_blank">
	        		<i class="fa fa-rss"></i>
	        	</a>
	        	
	        	<a class="icon icon-twitter" href="http://twitter.com/" target="_blank">				
	        		<i class="fa fa-twitter"></i>
	        	</a>
	        	
	        	<a class="icon icon-facebook" href="http://facebook.com/" target="_blank">
	        		<i class="fa fa-facebook"></i>
	        	</a>
	        	
	        	<a class="icon icon-google-plus" href="http://plus.google.com/" target="_blank">
	        		<i class="fa fa-google-plus"></i>
	        	</a>
	        	
	        	<a class="icon icon-dribbble" href="http://dribbble.com/" target="_blank">
	        		<i class="fa fa-dribbble"></i>
	        	</a>
	        	
	        	<a class="icon icon-flickr" href="http://flickr.com/" target="_blank">
	        		<i class="fa fa-flickr"></i>
	        	</a>
	        	
	        	<a class="icon icon-foursquare" href="http://foursquare.com/" target="_blank">
	        		<i class="fa fa-foursquare"></i>
	        	</a>
	        	
	        	<a class="icon icon-instagram" href="http://instagram.com/" target="_blank">
	        		<i class="fa fa-instagram"></i>
	        	</a>
	        	
	        	<a class="icon icon-github" href="http://github.com/" target="_blank">
	        		<i class="fa fa-github"></i>
	        	</a>
	        	
	        	<a class="icon icon-tumblr" href="http://tumblr.com/" target="_blank">
	        		<i class="fa fa-tumblr"></i>
	        	</a>
	        	
	        	<a class="icon icon-pinterest" href="http://pinterest.com/" target="_blank">
	        		<i class="fa fa-pinterest"></i>
	        	</a>
	        	
	        	<a class="icon icon-linkedin" href="http://linkedin.com/" target="_blank">
	        		<i class="fa fa-linkedin"></i>
	        	</a>
	        	
	        	<a class="icon icon-vk" href="http://vk.com/" target="_blank">
	        		<i class="fa fa-vk"></i>
	        	</a>        </div>               
	    </section>
	</footer></main>

	<script src="/assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="/assets/js/main.min.js"></script>
</body>
</html>