<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>Creating a book review site from your Amazon book review RSS feed</title>	

	<meta name="description" content="">
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Creating a book review site from your Amazon book review RSS feed">
    <meta name="twitter:description" content="">
    <meta name="twitter:site" content="@username">
	<meta name="twitter:creator" content="@username">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Creating a book review site from your Amazon book review RSS feed">
    <meta property="og:description" content="">

    <link rel="stylesheet" href="/assets/css/style.css">

    <meta name="generator" content="Ghost ?" />
<link rel="alternate" type="application/rss+xml" title="Mixu&#39;s blog" href="/rss/">
<link rel="canonical" href="http://localhost:5000//2009/05/10/creating-a-book-review-site-from-your-amazon-book-review-rss-feed.md" />	
</head>
<body class="post-template">
	
<main id="container" role="main">
	<header class="header" role="banner" style="background-image: url(/assets/img/header.jpg);">
		<h1 class="blog-title">
			<a href="http://localhost:5000">Mixu&#x27;s blog</a>
		</h1>
		<div class="blog-description">A blog</div>
	</header>
	<nav class="menu" role="navigation">
		<a href="#">Home</a>
		<span class="delimiter">&#8226;</span>
		<a href="#">About</a>
		<span class="delimiter">&#8226;</span>
		<a href="#">Contacts</a>
	</nav>
	<section class="post-full">
		<article itemscope itemtype="http://schema.org/BlogPosting" role="article" class="post">
			<header class="post-header">        		
    			<h2 itemprop="name headline" class="post-title">
    				<a href="/2009/05/10/creating-a-book-review-site-from-your-amazon-book-review-rss-feed.html" itemprop="url">Creating a book review site from your Amazon book review RSS feed</a>
    			</h2>
    			<div class="post-meta">
        			<time datetime="2009-05-10" itemprop="datePublished">May 10, 2009</time>
        		</div>
        		<hr>
    		</header>
    		<section itemprop="articleBody" class="post-content">
    			<p>I figured the first thing to do in order to get my book reviews online was to set up the functionality to get them from Amazon and display them on my site. This way I can write reviews on Amazon and have them automatically added to my own site.</p>

<p>Amazon offers an RSS feed of your reviews under your profile, see the link in the &quot;Public Reviews Written by You&quot; heading on &quot;Your Profile&quot;. What we will do is use this RSS to create a new site. </p>

<p><b>Get Simplepie (and CodeIgniter, if you want to)</b></p>

<p>I am going to set up the site using the <a href="http://codeigniter.com/">CodeIgniter </a>MVC framework and the <a href="http://simplepie.org/">SimplePie </a>RSS reader library. You don&#39;t really need to use CodeIgniter, but I wanted to give it a try. First download SimplePie and move the simplepie.inc file under /application/libraries and rename it to &quot;simplepie.php&quot;. Set up CodeIgniter as instructed in the user guide.</p>

<p><b>Controller code</b></p>

<p>In your controller: </p>

<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-variable">$start</span> = <span class="hljs-number">0</span>, <span class="hljs-variable">$length</span> = <span class="hljs-number">5</span>)</span>
</span>{
    <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;load</span><span class="hljs-variable">-&gt;library</span>(<span class="hljs-string">&#39;simplepie&#39;</span>);
    <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;simplepie</span><span class="hljs-variable">-&gt;set_cache_location</span>(<span class="hljs-string">&#39;./system/cache&#39;</span>);

    <span class="hljs-comment">// amazon uses class and id attributes in their review, which are useful for styling the content inside CDATA - so allow those two, and the rest is default.</span>
    <span class="hljs-variable">$attribs</span> = <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;simplepie</span><span class="hljs-variable">-&gt;strip_attributes</span>;
    <span class="hljs-comment">// unset class and id</span>
    <span class="hljs-keyword">if</span> ((<span class="hljs-variable">$key</span> = array_search(<span class="hljs-string">&#39;class&#39;</span>, <span class="hljs-variable">$attribs</span>)) !== <span class="hljs-keyword">null</span>) {
        <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$attribs</span>[<span class="hljs-variable">$key</span>]);
    }
    <span class="hljs-keyword">if</span> ((<span class="hljs-variable">$key</span> = array_search(<span class="hljs-string">&#39;id&#39;</span>, <span class="hljs-variable">$attribs</span>)) !== <span class="hljs-keyword">null</span>) {
        <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$attribs</span>[<span class="hljs-variable">$key</span>]);
    }
    <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;simplepie</span><span class="hljs-variable">-&gt;strip_attributes</span>(<span class="hljs-variable">$attribs</span>);
    <span class="hljs-comment">// change this to your Amazon book review RSS feed address</span>
    <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;simplepie</span><span class="hljs-variable">-&gt;set_feed_url</span>(<span class="hljs-string">&#39;<a href="http://www.amazon.com/rss/people/A31F72N3CBFDG2/reviews/ref=cm_rss_member_rev_manlink">http://www.amazon.com/rss/people/A31F72N3CBFDG2/reviews/ref=cm_rss_member_rev_manlink</a>&#39;</span>);
    <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;simplepie</span><span class="hljs-variable">-&gt;init</span>();
    <span class="hljs-variable">$data</span>[<span class="hljs-string">&#39;feed&#39;</span>] = <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;simplepie</span>;
    <span class="hljs-variable">$data</span>[<span class="hljs-string">&#39;start&#39;</span>] = <span class="hljs-variable">$start</span>;
    <span class="hljs-variable">$data</span>[<span class="hljs-string">&#39;length&#39;</span>] = <span class="hljs-variable">$length</span>;
    <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;load</span><span class="hljs-variable">-&gt;view</span>(<span class="hljs-string">&#39;show_rss&#39;</span>, <span class="hljs-variable">$data</span>);
}</code></pre><p><b>View code</b></p>

<p>After that, create the view (show_rss in my case). Create code to process the feed. I used the pagination code from the SimplePie documentation as the basis so that you can have separate pages for the items:</p>

<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$feed</span><span class="hljs-variable">-&gt;get_items</span>(<span class="hljs-variable">$start</span> + <span class="hljs-number">1</span>, <span class="hljs-variable">$length</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$item</span>) {
    <span class="hljs-variable">$feed2</span> = <span class="hljs-variable">$item</span><span class="hljs-variable">-&gt;get_feed</span>();
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#39;&lt;div class=&quot;latest-post&quot;&gt;
          &lt;h1 class=&quot;title&quot;&gt;&lt;a href=&quot;&#39;</span> . <span class="hljs-variable">$item</span><span class="hljs-variable">-&gt;get_permalink</span>() . <span class="hljs-string">&#39;&quot;&gt;&#39;</span> . <span class="hljs-variable">$item</span><span class="hljs-variable">-&gt;get_title</span>(<span class="hljs-keyword">true</span>) . <span class="hljs-string">&#39;&lt;/a&gt;&lt;/h1&gt;
          &lt;p class=&quot;meta&quot;&gt;Source: &lt;a href=&quot;&#39;</span> . <span class="hljs-variable">$feed2</span><span class="hljs-variable">-&gt;get_permalink</span>() . <span class="hljs-string">&#39;&quot;&gt;&#39;</span> . <span class="hljs-variable">$feed2</span><span class="hljs-variable">-&gt;get_title</span>() . <span class="hljs-string">&#39;&lt;/a&gt; | &#39;</span> . <span class="hljs-variable">$item</span><span class="hljs-variable">-&gt;get_date</span>(<span class="hljs-string">&#39;j M Y, g:i a&#39;</span>) . <span class="hljs-string">&#39;&lt;/p&gt;
          &lt;div class=&quot;entry&quot;&gt;
            &lt;p&gt;&#39;</span> . <span class="hljs-variable">$item</span><span class="hljs-variable">-&gt;get_content</span>() . <span class="hljs-string">&#39;&lt;/p&gt;
            &lt;span class=&quot;comments&quot;&gt;&#39;</span> . <span class="hljs-variable">$item</span><span class="hljs-variable">-&gt;get_date</span>(<span class="hljs-string">&#39;j M Y, g:i a&#39;</span>) . <span class="hljs-string">&#39;&lt;/span&gt;
          &lt;/div&gt;
        &lt;/div&gt;&#39;</span>;
}

<span class="hljs-comment">// Let&#39;s do our paging controls</span>
<span class="hljs-variable">$next</span> = (int)<span class="hljs-variable">$start</span> + (int)<span class="hljs-variable">$length</span>;
<span class="hljs-variable">$prev</span> = (int)<span class="hljs-variable">$start</span> - (int)<span class="hljs-variable">$length</span>;

<span class="hljs-comment">// Create the NEXT link</span>
<span class="hljs-variable">$nextlink</span> = <span class="hljs-string">&#39;&lt;a href=&quot;&#39;</span> . site_url(<span class="hljs-keyword">array</span>(<span class="hljs-string">&#39;welcome&#39;</span>, <span class="hljs-string">&#39;index&#39;</span>, <span class="hljs-string">&#39;start&#39;</span> =&gt; <span class="hljs-variable">$next</span>, <span class="hljs-string">&#39;length&#39;</span> =&gt; <span class="hljs-variable">$length</span>)) . <span class="hljs-string">&#39;&quot;&gt;Next &amp;raquo;&lt;/a&gt;&#39;</span>;
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$next</span> &gt; <span class="hljs-variable">$max</span>) {
    <span class="hljs-variable">$nextlink</span> = <span class="hljs-string">&#39;Next &amp;raquo;&#39;</span>;
}

<span class="hljs-comment">// Create the PREVIOUS link</span>
<span class="hljs-variable">$prevlink</span> = <span class="hljs-string">&#39;&lt;a href=&quot;&#39;</span> . site_url(<span class="hljs-keyword">array</span>(<span class="hljs-string">&#39;welcome&#39;</span>, <span class="hljs-string">&#39;index&#39;</span>, <span class="hljs-string">&#39;start&#39;</span> =&gt; <span class="hljs-variable">$prev</span>, <span class="hljs-string">&#39;length&#39;</span> =&gt; <span class="hljs-variable">$length</span>)) . <span class="hljs-string">&#39;&quot;&gt;&amp;laquo; Previous&lt;/a&gt;&#39;</span>;
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$prev</span> &lt; <span class="hljs-number">0</span> &amp;&amp; (int)<span class="hljs-variable">$start</span> &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-variable">$prevlink</span> = <span class="hljs-string">&#39;&lt;a href=&quot;&#39;</span> . site_url(<span class="hljs-keyword">array</span>(<span class="hljs-string">&#39;welcome&#39;</span>, <span class="hljs-string">&#39;index&#39;</span>, <span class="hljs-string">&#39;start&#39;</span> =&gt; <span class="hljs-variable">$next</span>, <span class="hljs-string">&#39;length&#39;</span> =&gt; <span class="hljs-variable">$length</span>)) . <span class="hljs-string">&#39;&quot;&gt;&amp;laquo; Previous&lt;/a&gt;&#39;</span>;
} <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$prev</span> &lt; <span class="hljs-number">0</span>) {
    <span class="hljs-variable">$prevlink</span> = <span class="hljs-string">&#39;&amp;laquo; Previous&#39;</span>;
}

<span class="hljs-comment">// Normalize the numbering for humans</span>
<span class="hljs-variable">$begin</span> = (int)<span class="hljs-variable">$start</span> + <span class="hljs-number">1</span>;
<span class="hljs-variable">$end</span> = (<span class="hljs-variable">$next</span> &gt; <span class="hljs-variable">$max</span>) ? <span class="hljs-variable">$max</span> : <span class="hljs-variable">$next</span>;

<span class="hljs-keyword">echo</span> <span class="hljs-string">&#39;&lt;div class=&quot;latest-post&quot;&gt;
&lt;p&gt;Showing &#39;</span> . <span class="hljs-variable">$begin</span> . <span class="hljs-string">&#39;&amp;ndash;&#39;</span> . <span class="hljs-variable">$end</span> . <span class="hljs-string">&#39; out of &#39;</span> . <span class="hljs-variable">$max</span> . <span class="hljs-string">&#39; | &#39;</span> . <span class="hljs-variable">$prevlink</span> . <span class="hljs-string">&#39; | &#39;</span> . <span class="hljs-variable">$nextlink</span> . <span class="hljs-string">&#39; | &lt;a href=&quot;&#39;</span> . site_url(<span class="hljs-keyword">array</span>(<span class="hljs-string">&#39;welcome&#39;</span>, <span class="hljs-string">&#39;index&#39;</span>, <span class="hljs-string">&#39;start&#39;</span> =&gt; <span class="hljs-variable">$start</span>, <span class="hljs-string">&#39;length&#39;</span> =&gt; <span class="hljs-string">&#39;5&#39;</span>)) . <span class="hljs-string">&#39;&quot;&gt;5&lt;/a&gt;, &lt;a href=&quot;&#39;</span> . site_url(<span class="hljs-keyword">array</span>(<span class="hljs-string">&#39;welcome&#39;</span>, <span class="hljs-string">&#39;index&#39;</span>, <span class="hljs-string">&#39;start&#39;</span> =&gt; <span class="hljs-variable">$start</span>, <span class="hljs-string">&#39;length&#39;</span> =&gt; <span class="hljs-string">&#39;10&#39;</span>)) . <span class="hljs-string">&#39;&quot;&gt;10&lt;/a&gt;, or &lt;a href=&quot;&#39;</span> . site_url(<span class="hljs-keyword">array</span>(<span class="hljs-string">&#39;welcome&#39;</span>, <span class="hljs-string">&#39;index&#39;</span>, <span class="hljs-string">&#39;start&#39;</span> =&gt; <span class="hljs-variable">$start</span>, <span class="hljs-string">&#39;length&#39;</span> =&gt; <span class="hljs-string">&#39;20&#39;</span>)) . <span class="hljs-string">&#39;&quot;&gt;20&lt;/a&gt; at a time.&lt;/p&gt;
&lt;/div&gt;&#39;</span>;</code></pre><p><b>CSS stylesheet</b></p>

<p>Finally, add a stylesheet. I used one from <a href="http://www.freecsstemplates.org/">Free CSS Templates</a>. I also made the following minor tweaks:</p>
<pre class="hljs"><code><span class="hljs-tag">span</span><span class="hljs-class">.amzRssByline</span> <span class="hljs-rules">{
  <span class="hljs-comment">/<em> Adds newline before the by line in reviews </em>/</span>
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> block</span></span>;
<span class="hljs-rule">}</span></span>

<span class="hljs-tag">div</span><span class="hljs-class">.entry</span> <span class="hljs-tag">img</span> <span class="hljs-rules">{
  <span class="hljs-comment">/<em> Floats the review picture </em>/</span>
 <span class="hljs-rule"><span class="hljs-attribute">float</span>:<span class="hljs-value"> left</span></span>;
 <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> block</span></span>;

<span class="hljs-rule">}</span></span>
<span class="hljs-tag">div</span><span class="hljs-class">.entry</span> <span class="hljs-tag">table</span> <span class="hljs-tag">div</span> <span class="hljs-rules">{
  <span class="hljs-comment">/<em> Adds a margin after the review heading </em>/</span>
 <span class="hljs-rule"><span class="hljs-attribute">margin-bottom</span>:<span class="hljs-value"> <span class="hljs-number">10px</span></span></span>;
<span class="hljs-rule">}</span></span></code></pre><p>Here is the result: <a href="http://books.mixu.net/">http://books.mixu.net/</a></p>

    		</section>
    		<footer class="post-footer">
    			<div itemscope itemprop="author" itemtype="http://schema.org/Person" class="post-author">
	                	<img itemprop="image" src="http://www.gravatar.com/avatar/F0AF2953911805542C66FD43B2F8FC38?s=155" alt="Mixu" class="post-author-avatar">
					<div class="post-author-info">
		              	<span itemprop="name">Mixu</span>
		              	<p itemprop="description" class="post-author-bio">Node.js developer</p>
	              	</div>
    			</div>
    		</footer>
		</article>
		
		<section itemprop="comment" class="post-comments">
			<div id="disqus_thread"></div>
			<script type="text/javascript">            
				var disqus_shortname = 'example';
		
			    (function() {
			        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
			        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
			        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			    })();
			</script>
			<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
			<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
		</section>	</section>

	<footer class="footer" role="contentinfo">
		<div class="social-links-line"></div>
		<section class="social-links">
	        <div class="social-links-inner">
	        	<a class="icon icon-feed" href="http://localhost:5000/rss/" target="_blank">
	        		<i class="fa fa-rss"></i>
	        	</a>
	        	
	        	<a class="icon icon-twitter" href="http://twitter.com/" target="_blank">				
	        		<i class="fa fa-twitter"></i>
	        	</a>
	        	
	        	<a class="icon icon-facebook" href="http://facebook.com/" target="_blank">
	        		<i class="fa fa-facebook"></i>
	        	</a>
	        	
	        	<a class="icon icon-google-plus" href="http://plus.google.com/" target="_blank">
	        		<i class="fa fa-google-plus"></i>
	        	</a>
	        	
	        	<a class="icon icon-dribbble" href="http://dribbble.com/" target="_blank">
	        		<i class="fa fa-dribbble"></i>
	        	</a>
	        	
	        	<a class="icon icon-flickr" href="http://flickr.com/" target="_blank">
	        		<i class="fa fa-flickr"></i>
	        	</a>
	        	
	        	<a class="icon icon-foursquare" href="http://foursquare.com/" target="_blank">
	        		<i class="fa fa-foursquare"></i>
	        	</a>
	        	
	        	<a class="icon icon-instagram" href="http://instagram.com/" target="_blank">
	        		<i class="fa fa-instagram"></i>
	        	</a>
	        	
	        	<a class="icon icon-github" href="http://github.com/" target="_blank">
	        		<i class="fa fa-github"></i>
	        	</a>
	        	
	        	<a class="icon icon-tumblr" href="http://tumblr.com/" target="_blank">
	        		<i class="fa fa-tumblr"></i>
	        	</a>
	        	
	        	<a class="icon icon-pinterest" href="http://pinterest.com/" target="_blank">
	        		<i class="fa fa-pinterest"></i>
	        	</a>
	        	
	        	<a class="icon icon-linkedin" href="http://linkedin.com/" target="_blank">
	        		<i class="fa fa-linkedin"></i>
	        	</a>
	        	
	        	<a class="icon icon-vk" href="http://vk.com/" target="_blank">
	        		<i class="fa fa-vk"></i>
	        	</a>        </div>               
	    </section>
	</footer></main>

	<script src="/assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="/assets/js/main.min.js"></script>
</body>
</html>