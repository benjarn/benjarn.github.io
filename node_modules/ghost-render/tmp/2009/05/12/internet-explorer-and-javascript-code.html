<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>Internet Explorer and JavaScript code</title>	

	<meta name="description" content="">
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Internet Explorer and JavaScript code">
    <meta name="twitter:description" content="">
    <meta name="twitter:site" content="@username">
	<meta name="twitter:creator" content="@username">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Internet Explorer and JavaScript code">
    <meta property="og:description" content="">

    <link rel="stylesheet" href="/assets/css/style.css">

    <meta name="generator" content="Ghost ?" />
<link rel="alternate" type="application/rss+xml" title="Mixu&#39;s blog" href="/rss/">
<link rel="canonical" href="http://localhost:5000//2009/05/12/internet-explorer-and-javascript-code.md" />	
</head>
<body class="post-template">
	
<main id="container" role="main">
	<header class="header" role="banner" style="background-image: url(/assets/img/header.jpg);">
		<h1 class="blog-title">
			<a href="http://localhost:5000">Mixu&#x27;s blog</a>
		</h1>
		<div class="blog-description">A blog</div>
	</header>
	<nav class="menu" role="navigation">
		<a href="#">Home</a>
		<span class="delimiter">&#8226;</span>
		<a href="#">About</a>
		<span class="delimiter">&#8226;</span>
		<a href="#">Contacts</a>
	</nav>
	<section class="post-full">
		<article itemscope itemtype="http://schema.org/BlogPosting" role="article" class="post">
			<header class="post-header">        		
    			<h2 itemprop="name headline" class="post-title">
    				<a href="/2009/05/12/internet-explorer-and-javascript-code.html" itemprop="url">Internet Explorer and JavaScript code</a>
    			</h2>
    			<div class="post-meta">
        			<time datetime="2009-05-12" itemprop="datePublished">May 12, 2009</time>
        		</div>
        		<hr>
    		</header>
    		<section itemprop="articleBody" class="post-content">
    			<p>Update: Added the song &quot;IE is being mean to me&quot; at the bottom of the post.</p>
<p>I don&#39;t usually write &quot;raw&quot; JavaScript code, that is, JS code that does not use an existing framework - mainly because using code that has been tested in multiple browsers is better in most cases than writing your own code from scratch and testing it with different browsers.</p>
<p>However, every now and then it seems a project is small (and non-commercial) so that using a framework would be overkill. These are the times when the differences between Internet Explorer&#39;s JavaScript support and that of other browsers is painfully obvious. Here are two relatively recent examples and solutions:</p>
<h3>1. The IE innerHTML and &quot;Unknown runtime error&quot;</h3>
The JS engine in IE is notoriously unhelpful when encountering errors. One thing in particular has bit me in the ass so many times it is not funny anymore. This is the occurrence of a &quot;Unknown runtime error&quot; when attempting to assign a value to an element in IE via the innerHTML attribute. For example:
<pre lang="javascript">document.getElementById(&#39;containing_element_id&#39;).innerHTML
    = &#39;<a href="http://something">A link text</a>&#39;;</pre>
<strong>Looks innocent, doesn&#39;t it? However, in IE this code may or may not fail with an unknown runtime error depending on the context.</strong> For example, if another link is already applied to the containing element, then this code will fail on IE. Firefox, Opera and Safari will perform some code cleanup and allow this to work as expected (the content of the element is changed to that link). IE, on the other hand, fails with little warning. The point is, IE is very strict when it comes to nesting elements - in the specifications, nested links are not allowed.

<strong>This is not a bad thing in my opinion - standards ought to be followed. The problem is, IE will not give you any clues as to what went wrong. </strong>If the code is more complex than in the example, and it mostly is, then this will take a long time to correct.

There is one way to diagnose whether this problem is due to a previous tag which ought to closed per specifications: in IE8, you can use the debugging tools (F12) and set a breakpoint at the offending line of code. If the element itself can be retrieved via getElementById, then the problem is probably with a runaway tag somewhere earlier on the page. Once you find the offending tag (or the logic that generated it), you can fix the problem.
<h3>2. The IE extra comma error</h3>
A very painful bug that took me long time to hunt down was related to how IE handles object initialization. In any complex application, you are most likely generating JavaScript code or setting JavaScript variables from the server using some other programming language, for example by generating JSON data structures via PHP:
<pre lang="php">foreach ($a as $k =&gt; $v) {
   $result[] = json_encode($k).&#39;:&#39;.json_encode($v);
}
   $data = &#39;{&#39; . join(&#39;,&#39;, $result) . &#39;}&#39;;</pre>
At some point this data is combined and outputted to the browser as JavaScript code. Sometimes there will be cases in which an additional comma (&quot;,&quot;) is left on that JSON string because of some data not being included. In other browsers, this is not a problem: Firefox for instance can handle code like:
<pre lang="javascript">var js_arr = {&quot;name1&quot;:&quot;value1&quot;,&quot;name2&quot;:&quot;value2&quot;,&quot;name3&quot;:&quot;value3&quot;,};</pre>
<strong>See that extra comma at the end? It will cause IE to fail silently and prevent the rest of the code from being executed!</strong> You can imagine how much fun it is to spend a few days debugging complex AJAX UI code to find that a single additional character was the problem.

And that can take more than a while, particularly if one does not know what to look for. And once you find the problem, you will not know whether to scream or to cry. My advice? Stick to tested code and be aware of these errors when you start debugging to avoid going on a wild goose chase.

<h3>IE is being mean to me again</h3>

<p>Somebody linked to this, I think it&#39;s awesome and probably appropriate if you arrived here via Google:</p>
<p><em>&quot;I tried Jquery, Moo tools and Prototype,
but IE still won&#39;t display my widget right</p>
<p>and have you experienced the horror
of debugging in Internet Explorer?</p>
<p>I&#39;d like to say that I simply do not care,
but how can I ignore so much market share?&quot;</em></p>
<p>httpv://www.youtube.com/watch?v=vTTzwJsHpU8</p>
<h2 id="comments">Comments</h2>
<p><strong><a href="#28" title="2010-03-22 19:49:53">Ale</a>:</strong> Thanks for the song.
I really feel identified :)</p>

    		</section>
    		<footer class="post-footer">
    			<div itemscope itemprop="author" itemtype="http://schema.org/Person" class="post-author">
	                	<img itemprop="image" src="http://www.gravatar.com/avatar/F0AF2953911805542C66FD43B2F8FC38?s=155" alt="Mixu" class="post-author-avatar">
					<div class="post-author-info">
		              	<span itemprop="name">Mixu</span>
		              	<p itemprop="description" class="post-author-bio">Node.js developer</p>
	              	</div>
    			</div>
    		</footer>
		</article>
		
		<section itemprop="comment" class="post-comments">
			<div id="disqus_thread"></div>
			<script type="text/javascript">            
				var disqus_shortname = 'example';
		
			    (function() {
			        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
			        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
			        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			    })();
			</script>
			<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
			<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
		</section>	</section>

	<footer class="footer" role="contentinfo">
		<div class="social-links-line"></div>
		<section class="social-links">
	        <div class="social-links-inner">
	        	<a class="icon icon-feed" href="http://localhost:5000/rss/" target="_blank">
	        		<i class="fa fa-rss"></i>
	        	</a>
	        	
	        	<a class="icon icon-twitter" href="http://twitter.com/" target="_blank">				
	        		<i class="fa fa-twitter"></i>
	        	</a>
	        	
	        	<a class="icon icon-facebook" href="http://facebook.com/" target="_blank">
	        		<i class="fa fa-facebook"></i>
	        	</a>
	        	
	        	<a class="icon icon-google-plus" href="http://plus.google.com/" target="_blank">
	        		<i class="fa fa-google-plus"></i>
	        	</a>
	        	
	        	<a class="icon icon-dribbble" href="http://dribbble.com/" target="_blank">
	        		<i class="fa fa-dribbble"></i>
	        	</a>
	        	
	        	<a class="icon icon-flickr" href="http://flickr.com/" target="_blank">
	        		<i class="fa fa-flickr"></i>
	        	</a>
	        	
	        	<a class="icon icon-foursquare" href="http://foursquare.com/" target="_blank">
	        		<i class="fa fa-foursquare"></i>
	        	</a>
	        	
	        	<a class="icon icon-instagram" href="http://instagram.com/" target="_blank">
	        		<i class="fa fa-instagram"></i>
	        	</a>
	        	
	        	<a class="icon icon-github" href="http://github.com/" target="_blank">
	        		<i class="fa fa-github"></i>
	        	</a>
	        	
	        	<a class="icon icon-tumblr" href="http://tumblr.com/" target="_blank">
	        		<i class="fa fa-tumblr"></i>
	        	</a>
	        	
	        	<a class="icon icon-pinterest" href="http://pinterest.com/" target="_blank">
	        		<i class="fa fa-pinterest"></i>
	        	</a>
	        	
	        	<a class="icon icon-linkedin" href="http://linkedin.com/" target="_blank">
	        		<i class="fa fa-linkedin"></i>
	        	</a>
	        	
	        	<a class="icon icon-vk" href="http://vk.com/" target="_blank">
	        		<i class="fa fa-vk"></i>
	        	</a>        </div>               
	    </section>
	</footer></main>

	<script src="/assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="/assets/js/main.min.js"></script>
</body>
</html>